ScreenManager:
    MainScreen:
    ItemsScreen:
    NewItemScreen:
    ViewItemScreen:
    TemplateCreateScreen:
    EditTemplateScreen

<MainScreen>
    name: "main_screen"
    id: listar
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            id: topbar
            type: "small"
            elevation: 2
            MDTopAppBarTitle:
                text: "Lister"
            MDTopAppBarTrailingButtonContainer:
                MDActionTopAppBarButton:
                    icon: "eraser"
                    on_release: root.reset_list()
                MDActionTopAppBarButton:
                    icon: "magnify"
                    on_release: root.open_search_dialog()
                MDActionTopAppBarButton:
                    id: dots
                    icon: "dots-vertical"
                    on_release: root.main_menu_open(self)

            
        ScrollView:
            pos_hint: {'center_y': 0.5, "center_x": 0.5}
            size_hint_x: 0.9
            spacing: 10

            MDList:
                id: list_container
   
    MDFabButton:
        icon: "plus-thick"
        id: menu_btn
        on_release: root.manager.current = "template_create_screen"
        pos_hint: {'center_x': .85, 'center_y': .1}
    

<ListOfLists>
    id: list_of_lists
    size_hint_y: None

    MDListItem:
        id: list_of_list_item
        on_release: root.on_release()
        MDListItemHeadlineText:
            id: list_name
            text: "Headline"

        MDIconButton:
            icon: "trash-can-outline"
            theme_text_color: "Custom"
            text_color: 1, 0, 0, 1
            on_release: (root.delete_list_dialog(), app.refresh_folder_view())


<ListOfItems>
    id: list_of_items
    size_hint_y: None
    height: list_item.height
    type_swipe: "hand"
    MDCardSwipeLayerBox:
        padding: "8dp"
        MDIconButton:
            pos_hint: {"center_y": 0.5}
            icon: "trash-can-outline"
            theme_text_color: "Custom"
            text_color: 1, 0, 0, 1
            on_release: (root.delete_item(list_of_items), app.refresh_folder_view())

        MDIconButton:
            id: archive_btn
            pos_hint: {"center_y": 0.5}
            icon: "archive-outline"
            theme_text_color: "Custom"
            text_color: 50, 50, 0, 1
            on_release: (root.archive_item(list_of_items), app.refresh_folder_view())

    MDCardSwipeFrontBox:
        _no_ripple_effect: True
        MDListItem:
            id: list_item
            on_press: root.on_press()
            MDListItemHeadlineText:
                id: headline
                text: "Headline"
            MDIconButton:
                id: check
                pos_hint: {"center_y": 0.5}
                icon: "checkbox-blank-outline"
                on_release: root.mark(check)

<NewFieldForm>
    MDBoxLayout:
        orientation:"horizontal"
        size_hint_y:None
        adaptive_height:True
        padding:10

        MDTextField:
            hint_text:"Field name..."
            id: name
            mode:"outlined"
            input_type:"text"

        MDDropDownItem:
            id: category_item
            on_release: root.menu_open(self)

            MDDropDownItemText:
                text: "Text"
                id: category_text

<NewItemForm>
    adaptive_height: True
    MDTextField:
        id: new_field_value
        MDTextFieldHintText:
            id: helper_text
            mode: "persistent"
    MDTextFieldTrailingIcon:
        pos_hint: {"center_y": 0.5}
        id: field_type_icon
        icon: "note-text-outline"
     

<ItemsScreen>
    name: "items_screen"
    id: items_screen

    MDBoxLayout:
        orientation: "vertical"
        MDTopAppBar:
            id: topbar
            type: "small"
            elevation: 2
            MDTopAppBarTitle:
                text: "Lister"
            MDTopAppBarTrailingButtonContainer:
                MDActionTopAppBarButton:
                    icon: "eraser"
                    on_release: root.reset_list()
                MDActionTopAppBarButton:
                    icon: "magnify"
                    on_release: root.open_search_dialog()
                MDActionTopAppBarButton:
                    id: dots
                    icon: "dots-vertical"
                    on_release: root.menu_open(self)

        #MDTopAppBar:
        #    id: topbar
        #    halign: "center"
        #    right_action_items: [["eraser", lambda x: root.reset_list()],["magnify", lambda x: root.open_search_dialog()], ["dots-vertical", lambda x: root.menu_open(x)]]
        #    elevation: 2

        MDBoxLayout:
            id: sort_layout
            size_hint_y: 0.1
            padding: [65, 0, 0, 0]

        ScrollView:
            pos_hint: {'center_y': 0.5, "center_x": 0.5}
            size_hint_x: 0.9
            spacing: 10

            MDList:
                id: item_list

        MDBoxLayout:
            size_hint: (.9, 0.25)
            pos_hint: {'center_y': 0.5, "center_x": 0.5}
            MDIconButton:
                text: "Back"
                icon: "backspace"
                icon_size: "30sp"
                on_release: root.manager.current = 'main_screen'
                elevation: 2
                gravity: "left"
                pos_hint: {"center_y": 0.5}
            Widget:
            MDIconButton:
                text: "New"
                icon: "pencil-outline"
                icon_size: "30sp"
                on_release: root.new_item(topbar.title) 
                elevation: 2
                gravity: "right"
                pos_hint: {"center_y": 0.5}


<NewItemScreen>
    name: "new_item_screen"
    id: new_item

    MDLabel:
        id: item_title
        halign: "center"
        font_size: dp(24)
        markup: True
        pos_hint: {"y": 0.45}

    ScrollView:
        pos_hint: {'top': 0.5 + 0.8/2}
        MDBoxLayout:
            orientation: "vertical"
            spacing: dp(20)
            padding: dp(20)
            adaptive_height:True
            size_hint_y: None
            id: added_items

    MDBoxLayout:
        size_hint: (.9, 0.25)
        pos_hint: {'center_y': 0.1, "center_x": 0.5}
        MDIconButton:
            text: "Back"
            icon: "backspace"
            icon_size: "30sp"
            on_release: root.manager.current = 'items_screen'
            gravity: "left"
            pos_hint: {"center_y": 0.5}
        Widget:
        MDIconButton:
            text: "Save"
            icon: "content-save"
            icon_size: "30sp"
            on_release: root.on_save()
            gravity: "right"
            pos_hint: {"center_y": 0.5}
   
    

<ViewItemScreen>
    name: "view_item_screen"
    orientation: "vertical"
    id: view_item

    MDLabel:
        id: item_title
        halign: "center"
        opacity: 0
        pos_hint: {"y": 0.45}

    MDLabel:
        id: display_title
        halign: "center"
        font_size: dp(24)
        markup: True
        pos_hint: {"y": 0.45}

    ScrollView:
        pos_hint: {'top': 0.5 + 0.8/2}
        MDBoxLayout:
            orientation: "vertical"
            adaptive_height:True
            size_hint_y: None
            padding: dp(20)
            spacing: dp(20)
            id: added_items

    MDBoxLayout:
        size_hint: (.9, 0.25)
        pos_hint: {'center_y': 0.1, "center_x": 0.5}
        MDIconButton:
            text: "Back"
            icon: "backspace"
            icon_size: "30sp"
            on_release: root.manager.current = 'items_screen'
            gravity: "left"
            pos_hint: {"center_y": 0.5}
        Widget:
        MDIconButton:
            text: "Save"
            icon: "content-save"
            icon_size: "30sp"
            on_release: root.on_save()
            gravity: "right"
            pos_hint: {"center_y": 0.5}



<TemplateCreateScreen>
    name: "template_create_screen"
    id: template_create_screen

    MDBoxLayout:
        orientation: "horizontal"
        padding: [20, 20, 20, 20]

        MDTextField:
            pos_hint: {"top": 0.9}
            id: list_name
            hint_text: "List Name"
            mode: "outlined"
            input_type: "text"

        MDIconButton:
            pos_hint: {"top": 0.9}
            icon: "plus-thick"
            on_release: root.add_field()

    MDList:
        size_hint_x: .8
        pos_hint: {"top": 0.8, "center_x": 0.5}
        id: added_fields
        padding: [50, 0, 50, 25]


    MDBoxLayout:
        size_hint: (.9, 0.25)
        pos_hint: {'center_y': 0.1, "center_x": 0.5}
        MDIconButton:
            text: "Back"
            icon: "backspace"
            icon_size: "30sp"
            on_release: root.manager.current = "main_screen"
            gravity: "left"
            pos_hint: {"center_y": 0.5}
        Widget:
        MDIconButton:
            text: "Save"
            icon: "content-save"
            icon_size: "30sp"
            on_release: (root.on_save(), app.refresh_folder_view())
            gravity: "right"
            pos_hint: {"center_y": 0.5}

<EditTemplateScreen>
    name: "edit_template_screen"
    id: edit_templat_screen

    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            id: topbar
            halign: "center"
            elevation: 2

        MDTextField:
            id: template_text
            multiline: True
            size: 1, 1
            pos_hint: {"center_y": .9}

        MDLabel:

    MDBoxLayout:
        size_hint: (.9, 0.25)
        pos_hint: {'center_y': 0.1, "center_x": 0.5}
        MDIconButton:
            text: "Back"
            icon: "backspace"
            icon_size: "30sp"
            on_release: root.manager.current = "main_screen"
            gravity: "left"
            pos_hint: {"center_y": 0.5}
        Widget:
        MDIconButton:
            text: "Save"
            icon: "content-save"
            icon_size: "30sp"
            on_release: root.on_save()
            gravity: "right"
            pos_hint: {"center_y": 0.5}


<SearchDialog>:
    MDDialogContentContainer:
        MDTextField:
            id: search_field
        MDTextFieldHintText:
            hint_text: "Search"
    MDDialogButtonContainer:
        MDButton:
            id: cancel_btn
            MDButtonText:
                text: "Cancel"
        MDButton:
            id: search_btn
            MDButtonText:
                text: "Search"

