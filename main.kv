ScreenManager:
    MainScreen:
    ItemsScreen:
    NewItemScreen:
    ViewItemScreen:
    TemplateCreateScreen:
    EditTemplateScreen

<IconButton>:
    size_hint: None, None
    size: dp(48), dp(48)

<MainScreen>
    name: "main_screen"
    id: listar
    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            title: "Lister"
            id: topbar
            halign: "center"
            right_action_items: [["eraser", lambda x: root.reset_list()],["magnify", lambda x: root.open_search_dialog()], ["dots-vertical", lambda x: root.main_menu_open(x)]]
            elevation: 2
            
        ScrollView:
            pos_hint: {"center_y": 0.5, "center_x": 0.5}
            size_hint: 0.9, 0.8
    
            MDList:
                spacing: "16dp"
                id: container
    
    MDFloatingActionButton:
        icon: "plus-thick"
        id: menu_btn
        on_release: root.manager.current = "template_create_screen"
        pos_hint: {'center_x': .85, 'center_y': .1}
    

<ListOfLists>
    id: list_of_lists


    IconRightWidget:
        icon: "trash-can-outline"
        theme_text_color: "Custom"
        text_color: 1, 0, 0, 1
        on_release: (root.delete_list_dialog(), app.refresh_folder_view())


<ListOfItems>
    id: list_of_items
    markup: True


    MDBoxLayout:
        pos_hint: {"center_x": 0.85, "center_y": 0.5}
        adaptive_width: True
        IconLeftWidget:
            id: check
            spacing: 20
            icon: "checkbox-blank-outline"
            on_release: root.mark(check, list_of_items)

        MDIconButton:
            pos_hint: {"center_y": 0.5}
            icon: "trash-can-outline"
            theme_text_color: "Custom"
            text_color: 1, 0, 0, 1
            on_release: (root.delete_item(list_of_items), app.refresh_folder_view())

        MDIconButton:
            id: archive_btn
            pos_hint: {"center_y": 0.5}
            icon: "archive-outline"
            theme_text_color: "Custom"
            text_color: 50, 50, 0, 1
            on_release: (root.archive_item(list_of_items), app.refresh_folder_view())

<ItemsScreen>
    name: "items_screen"
    id: items_screen

    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            id: topbar
            halign: "center"
            right_action_items: [["eraser", lambda x: root.reset_list()],["magnify", lambda x: root.open_search_dialog()], ["dots-vertical", lambda x: root.menu_open(x)]]
            elevation: 2

        MDBoxLayout:
            id: sort_layout
            size_hint_y: 0.1
            padding: [65, 0, 0, 0]

        ScrollView:
            pos_hint: {'center_y': 0.5, "center_x": 0.5}
            size_hint_x: 0.9
            spacing: 10
            id: item_list

        MDBoxLayout:
            size_hint: (.9, 0.25)
            pos_hint: {'center_y': 0.5, "center_x": 0.5}
            MDFillRoundFlatIconButton:
                text: "Back"
                icon: "backspace"
                icon_size: "30sp"
                on_release: root.manager.current = 'main_screen'
                elevation: 2
                gravity: "left"
                pos_hint: {"center_y": 0.5}
            Widget:
            MDFillRoundFlatIconButton:
                text: "New"
                icon: "pencil-outline"
                icon_size: "30sp"
                on_release: root.new_item(topbar.title) 
                elevation: 2
                gravity: "right"
                pos_hint: {"center_y": 0.5}


<NewItemScreen>
    name: "new_item_screen"
    id: new_item

    MDLabel:
        id: item_title
        halign: "center"
        font_size: dp(24)
        markup: True
        pos_hint: {"y": 0.45}

    ScrollView:
        pos_hint: {'top': 0.5 + 0.8/2}
        MDBoxLayout:
            orientation: "vertical"
            adaptive_height:True
            size_hint_y: None
            padding: dp(20)
            spacing: dp(20)
            id: added_items

    MDBoxLayout:
        size_hint: (.9, 0.25)
        pos_hint: {'center_y': 0.1, "center_x": 0.5}
        MDFillRoundFlatIconButton:
            text: "Back"
            icon: "backspace"
            icon_size: "30sp"
            on_release: root.manager.current = 'items_screen'
            gravity: "left"
            pos_hint: {"center_y": 0.5}
        Widget:
        MDFillRoundFlatIconButton:
            text: "Save"
            icon: "content-save"
            icon_size: "30sp"
            on_release: root.on_save()
            gravity: "right"
            pos_hint: {"center_y": 0.5}
   
    

<ViewItemScreen>
    name: "view_item_screen"
    orientation: "vertical"
    id: view_item

    MDLabel:
        id: item_title
        halign: "center"
        opacity: 0
        pos_hint: {"y": 0.45}

    MDLabel:
        id: display_title
        halign: "center"
        font_size: dp(24)
        markup: True
        pos_hint: {"y": 0.45}

    ScrollView:
        pos_hint: {'top': 0.5 + 0.8/2}
        MDBoxLayout:
            orientation: "vertical"
            adaptive_height:True
            size_hint_y: None
            padding: dp(20)
            spacing: dp(20)
            id: added_items

    MDBoxLayout:
        size_hint: (.9, 0.25)
        pos_hint: {'center_y': 0.1, "center_x": 0.5}
        MDFillRoundFlatIconButton:
            text: "Back"
            icon: "backspace"
            icon_size: "30sp"
            on_release: root.manager.current = 'items_screen'
            gravity: "left"
            pos_hint: {"center_y": 0.5}
        Widget:
        MDFillRoundFlatIconButton:
            text: "Save"
            icon: "content-save"
            icon_size: "30sp"
            on_release: root.on_save()
            gravity: "right"
            pos_hint: {"center_y": 0.5}



<TemplateCreateScreen>
    name: "template_create_screen"
    id: template_create_screen

    MDBoxLayout:
        orientation: "horizontal"
        padding: [20, 20, 20, 20]

        MDTextField:
            pos_hint: {"top": 0.9}
            id: list_name
            hint_text: "List Name"
            mode: "round"
            input_type: "text"

        MDIconButton:
            pos_hint: {"top": 0.9}
            icon: "plus-thick"
            on_release: root.add_field()

    MDList:
        size_hint_x: .8
        pos_hint: {"top": 0.8, "center_x": 0.5}
        id: added_fields
        padding: [50, 0, 50, 25]

    MDBoxLayout:
        size_hint: (.9, 0.25)
        pos_hint: {'center_y': 0.1, "center_x": 0.5}
        MDFillRoundFlatIconButton:
            text: "Back"
            icon: "backspace"
            icon_size: "30sp"
            on_release: root.manager.current = "main_screen"
            gravity: "left"
            pos_hint: {"center_y": 0.5}
        Widget:
        MDFillRoundFlatIconButton:
            text: "Save"
            icon: "content-save"
            icon_size: "30sp"
            on_release: (root.on_save(), app.refresh_folder_view())
            gravity: "right"
            pos_hint: {"center_y": 0.5}

<EditTemplateScreen>
    name: "edit_template_screen"
    id: edit_templat_screen

    MDBoxLayout:
        orientation: "vertical"

        MDTopAppBar:
            id: topbar
            halign: "center"
            elevation: 2

        MDTextField:
            id: template_text
            multiline: True
            size: 1, 1
            pos_hint: {"center_y": .9}

        MDLabel:

    MDBoxLayout:
        size_hint: (.9, 0.25)
        pos_hint: {'center_y': 0.1, "center_x": 0.5}
        MDFillRoundFlatIconButton:
            text: "Back"
            icon: "backspace"
            icon_size: "30sp"
            on_release: root.manager.current = "main_screen"
            gravity: "left"
            pos_hint: {"center_y": 0.5}
        Widget:
        MDFillRoundFlatIconButton:
            text: "Save"
            icon: "content-save"
            icon_size: "30sp"
            on_release: root.on_save()
            gravity: "right"
            pos_hint: {"center_y": 0.5}


<CategoryInputDialog>
    orientation: "vertical"
    padding: dp(20)
    size_hint_y: None
    adaptive_height: True

    MDLabel:
        text: "Enter Categories"
    MDTextField:
        id: categories
        hint_text: "Category A, Category B..."
        helper_text_mode: "on_focus"
        padding: dp(10)

<SearchDialog>:
    size_hint: 0.5, None
    orientation: "vertical"

    MDTextField:
        id: search_field
        hint_text: "Search"

